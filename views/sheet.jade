include util
extends layout

block content
    style.
        .thumb-up-btn, #words-disp {
            transition: color 0.5s;
        }
        .thumb-up-icon {
            transition: transform 0.5s;
            transform: scale(1, 1);
        }
        .thumb-popping {
            transform: scale(0.8, 0.8);
        }
    header
        +normalNav()
    .row
        .col.s4
            .row
                .col.s12
                    .card.blue-grey.darken-1(style='margin-bottom: 0')
                        .card-content.white-text
                            h6= sheet.sheetName
                            p 上传者：#{sheet.user.username}
                            p 标签：
                            p(style='font-size: 12px') 简介：#{sheet.sheetIntro.length > 100 ? sheet.sheetIntro.substr(0, 96) + '....' : sheet.sheetIntro}
                        .card-action
                            a(href!='http://cdn.acgsounds.com/' + sheet._id + '.mid') 下载 MIDI
                            a(href!='http://cdn.acgsounds.com/' + sheet._id + '.pdf') 下载 PDF
                            a(href='#') 下载 SIB
                .col.s12
                    .card(style='margin-bottom: 0')
                        .card-content
                            a(href!='javascript:MIDIjs.play(\'http://cdn.acgsounds.com/' + sheet._id + '.mid\')')
                                i.material-icons play_circle_filled
                            | &nbsp;&nbsp;
                            a(href='#', onClick='MIDIjs.stop()')
                                i.material-icons stop
                            .secondary-content
                                | MIDI 播放控制
                            .progress
                                .determinate
                            .secondary-content.grey-text
                                span#currentTime
                                |  /
                                span#totalTime
                            br
                .col.s12
                    ul.collection#commentBox
                        .progress
                            .indeterminate
                        .row.center
                            | Loading...
                    div(id='template-pag-prev')
                        li.waves-effect(style='display: none', onclick='window.pagination.prev()')
                            a(href='javascript:;')
                                i.material-icons chevron_left
                    div(id='template-pag-prev-disabled', onclick='window.pagination.prev()')
                        li.disabled.waves-effect(style='display: none')
                            a(href='javascript:;')
                                i.material-icons chevron_left
                    div(id='template-pag-next')
                        li.waves-effect(style='display: none', onclick='window.pagination.next()')
                            a(href='javascript:;')
                                i.material-icons chevron_right
                    div(id='template-pag-next-disabled')
                        li.disabled.waves-effect(style='display: none', onclick='window.pagination.next()')
                            a(href='javascript:;')
                                i.material-icons chevron_right

                    div(id='template-pag-button')
                        li.waves-effect(style='display: none', onclick='window.pagination.go({0})')
                            a(href='javascript:;') {1}
                    div(id='template-pag-button-active')
                        li.active.waves-effect(style='display: none', onclick='window.pagination.go({0})')
                            a(href='javascript:;') {1}
                    div(id='template-pag-ellipsis')
                        li.waves-effect(style='display: none') …
                    ul.pagination(id='pag')
                    if user
                        div.input-field
                            textarea.materialize-textarea(id='text-comment')
                            label(for='text-comment')
                                = __('Say something')
                            span(id='words-disp', style='float: right')
                                | 500
                            a.waves-effect.waves-light.btn(id='btn-comment', style='width: 100%')
                                i.material-icons.left navigation
                                = __('Submit comment')
        .col.s8
            object#pdf(data!='http://cdn.acgsounds.com/' + sheet._id + '.pdf', type='application/pdf', style='width: 100%; height: 600px')

        .template-1(style='display: none')
            li.collection-item.avatar(id='comment-display-{2}')
                img.circle(src='', alt='')
                a.title(href='/user/{0}') {0}
                p {1}
                p.right-align.grey-text {4}
                .secondary-content.grey-text(style='margin-right: 90px; margin-top: -10px') {2}#
                .secondary-content.grey-text(style='margin-right: 40px; margin-top: -10px', id='comment-likes-{2}') {3}
                a.secondary-content.teal-text.text-lighten-4.thumb-up-btn(id='comment-thumbup-{2}', href='javascript:likeComment({2});', style='margin-top: -10px')
                    i.material-icons.thumb-up-icon thumb_up

block script
    script(src='/javascripts/runtime.min.js')
    script(src='/javascripts/comment.js')
    script(src='/javascripts/midievents.js')
    script(src='/javascripts/midifile.js')
    script(src='http://7xr4a5.com1.z0.glb.clouddn.com/lib/midi.js')

    script window.sheet_id = "#{sheet._id}";
    script(src='/javascripts/sheet.js')
